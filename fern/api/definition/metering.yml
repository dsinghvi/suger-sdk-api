imports:
  commons: commons.yml

services:
  http:
    MeteringService:
      auth: true
      base-path: /org/{orgId}
      path-parameters:
        orgId:
          docs: Organization ID
          type: string
      endpoints:
        getUsageRecordGroupsForEntitlement:
          path: /entitlement/{entitlementId}/usageRecordGroup
          method: GET
          display-name: list all UsageRecordGroups under the given entitlement
          path-parameters:
            entitlementId:
              docs: Entitlement ID
              type: string
          request:
            name: GetUsageRecordGroupsForEntitlementRequest
            query-parameters:
              limit:
                docs: List pagination size, default 20
                type: optional<integer>
              offset:
                docs: List pagination offset, default 0
                type: optional<integer>
          response: commons.ListUsageRecordGroupsResponse

        reportUsageRecordGroup:
          path: /entitlement/{entitlementId}/usageRecordGroup
          method: POST
          docs: >-
            It is recommended to provide the ID in the request body
            CreateUsageRecordGroupParams, so the report can be deduplicated. All
            duplicate report will return error code 409.
          display-name: Report new UsageRecordGroup.
          path-parameters:
            entitlementId:
              docs: Entitlement ID
              type: string
          request: CreateUsageRecordGroupParams
          response: commons.MeteringUsageRecordGroup

        getUsageRecordReportsForEntitlement:
          path: /entitlement/{entitlementId}/usageRecordReport
          method: GET
          display-name: list all UsageRecordReports under the given entitlement
          path-parameters:
            entitlementId:
              docs: Entitlement ID
              type: string
          request:
            name: GetUsageRecordReportsForEntitlementRequest
            query-parameters:
              entitlementTermId:
                docs: >-
                  The Entitlement Term ID, if not given, return the
                  UsageRecordReports of all Entitlement Terms under the
                  Entitlement
                type: optional<string>
          response: ListUsageRecordReportsResponse

        getUsageRecordGroupsForProduct:
          path: /product/{productId}/usageRecordGroup
          method: GET
          display-name: list all UsageRecordGroups under the given product
          path-parameters:
            productId:
              docs: Product ID
              type: string
          request:
            name: GetUsageRecordGroupsForProductRequest
            query-parameters:
              limit:
                docs: List pagination size, default 20
                type: optional<integer>
              offset:
                docs: List pagination offset, default 0
                type: optional<integer>
          response: commons.ListUsageRecordGroupsResponse

        getUsageRecordGroupsForOrganization:
          path: /usageRecordGroup
          method: GET
          display-name: list all UsageRecordGroups under the given organization
          request:
            name: GetUsageRecordGroupsForOrganizationRequest
            query-parameters:
              limit:
                docs: List pagination size, default 20
                type: optional<integer>
              offset:
                docs: List pagination offset, default 0
                type: optional<integer>
          response: commons.ListUsageRecordGroupsResponse

        getUsageRecordGroupById:
          path: /usageRecordGroup/{usageRecordGroupId}
          method: GET
          display-name: >-
            get an UsageRecordGroup by organization_entitlement_usage RecordGroup
            id
          path-parameters:
            usageRecordGroupId:
              docs: UsageRecordGroup ID
              type: string
          response: commons.MeteringUsageRecordGroup

types:
  CreateUsageRecordGroupParams:
    properties:
      entitlementID: string
      id: optional<string>
      organizationID: string
  
  ListUsageRecordReportsResponse:
    properties:
      usageRecordReports: optional<list<commons.MeteringUsageRecordReport>>
